(()=>{class t{constructor(t,e,n,i=!1){this.title=a(t),this.author=a(e),this.pages_total=n,this.pages_read=0,this.rating=0,this.categories=[],this.complete=i}}function e(){document.querySelector("main").innerHTML="",l()}function n(t,n){const r=document.createElement("div");r.title=t.title,r.id=`card ${n}`,r.className="card";const l=document.createElement("container");l.className="cardFace";const o=document.createElement("div");o.className="content";const a=document.createElement("progress");a.setAttribute("max",t.pages_total),a.setAttribute("id",`progress ${n}`),a.setAttribute("value",t.pages_read),a.setAttribute("title",`You're on page ${t.pages_read} out of ${t.pages_total}.`),a.addEventListener("click",(()=>{let n=parseInt(prompt("What page are you on?"));n>=t.pages_total&&(n=t.pages_total),n<0|!n||(t.pages_read=n,p(),e())})),o.appendChild(a);const c=document.createElement("div");c.className="rating-box",c.title=t.rating/20*10/10+" stars";const m=document.createElement("div");m.className="rating",m.style.width=t.rating+"%",c.setAttribute("id",`rating ${n}`),c.addEventListener("click",(e=>{const i=document.getElementById(`rating ${n}`);i.querySelector(".rating").style.width=e.layerX+"%",t.rating=e.layerX,i.title=t.rating/20*10/10+" stars",p()})),c.appendChild(m),o.appendChild(c);const b=document.createElement("p");b.textContent=`"${t.title}"`,b.title=`Title: "${t.title}"`,b.setAttribute("class","bookTitle"),o.appendChild(b);const A=document.createElement("p");A.textContent=t.author,A.title=`Author: "${t.author}"`,A.setAttribute("class","bookAuthor"),o.appendChild(A),l.appendChild(o);const h=document.createElement("div");h.setAttribute("class","cardButtons");const g=document.createElement("i");g.innerHTML="delete_forever",g.setAttribute("title","Remove book from library"),g.setAttribute("class","material-icons-round deleteButton"),g.setAttribute("id",`remove ${n}`),g.addEventListener("click",s),h.appendChild(g);const y=document.createElement("i");y.innerHTML="label",y.setAttribute("title","Add tags"),y.setAttribute("class","material-icons-round tagButton"),y.setAttribute("id",`tag ${n}`),y.addEventListener("click",i),h.appendChild(y);const E=document.createElement("i");E.innerHTML="create",E.setAttribute("title","Edit book details"),E.setAttribute("class","material-icons-round editButton"),E.setAttribute("id",`edit ${n}`),E.addEventListener("click",u),h.appendChild(E);const v=document.createElement("i");return t.complete?(v.innerHTML="check_circle_outline",v.setAttribute("title","Mark as unread")):(v.innerHTML="visibility",v.setAttribute("title","Mark as Complete")),v.setAttribute("class","material-icons-round completeButton"),v.setAttribute("id",`complete ${n}`),v.addEventListener("click",d),h.appendChild(v),l.appendChild(h),r.appendChild(l),r}function i(t){let e=m(this.id);const n=document.getElementById(`card ${e}`);n.querySelector(".cardFace").style.display="none";const i=document.createElement("div");i.setAttribute("class","tag-edit-container"),i.setAttribute("id",`tag edit container ${e}`);const l=document.createElement("div");l.setAttribute("class","tag-container"),l.setAttribute("id",`tag container ${e}`);const o=document.createElement("input");o.setAttribute("id",`tag input ${e}`),l.appendChild(o),o.addEventListener("keyup",(t=>{""!=o.value&&"Enter"===t.key&&(t.target.value.split(",").forEach((t=>{b[e].categories.push(t),p()})),r(t.target.id),o.value="")}));const a=document.createElement("i");a.setAttribute("type","button"),a.innerHTML="done",a.setAttribute("title","Done"),a.setAttribute("class","material-icons-round doneButton"),a.setAttribute("id",`finish tagging ${e}`),a.addEventListener("click",(()=>{n.querySelector(".cardFace").style.display="block";let t=m(this.id);document.getElementById(`tag edit container ${t}`).remove(),document.getElementById(`finish tagging ${t}`).remove()})),i.appendChild(l),n.append(i,a),r(e),o.focus()}function r(t){let e=m(t),n=b[e];const i=document.getElementById(`tag container ${e}`);i.querySelectorAll(".tag").forEach((t=>{t.parentElement.removeChild(t)})),n.categories.slice().reverse().forEach((t=>{i.prepend(function(t){const e=document.createElement("div");e.setAttribute("class","tag");const n=document.createElement("span");n.innerHTML=t;const i=document.createElement("i");return i.innerHTML="close",i.setAttribute("class","material-icons"),i.setAttribute("data-item",t),i.addEventListener("click",(e=>{const n=m(e.target.parentNode.parentNode.id),i=b[n];labelIndex=i.categories.indexOf(t),i.categories.splice(labelIndex,1),p(),r(n)})),e.appendChild(n),e.appendChild(i),e}(t))}))}function l(){const t=document.querySelector("main");t.appendChild(function(){const t=document.createElement("div");t.className="card",t.id="newBookForm";const e=document.createElement("button");e.id="addNewButton",e.title="Add new book to Library",e.textContent="+",e.addEventListener("click",(()=>{document.querySelector("#input-field").style.display="initial",e.style.display="none"})),t.appendChild(e);const n=document.createElement("form");n.id="input-field";const i=document.createElement("div"),r=document.createElement("input");i.appendChild(r),r.setAttribute("placeholder","Book Title"),r.setAttribute("id","title"),r.setAttribute("type","text"),r.setAttribute("name","title");const l=document.createElement("div"),a=document.createElement("input");l.appendChild(a),a.setAttribute("placeholder","Author"),a.setAttribute("id","author"),a.setAttribute("type","text"),a.setAttribute("name","author");const c=document.createElement("div"),d=document.createElement("input");c.appendChild(d),d.setAttribute("placeholder","Page count"),d.setAttribute("id","bookLength"),d.setAttribute("type","number"),d.setAttribute("name","bookLength"),d.setAttribute("min","0"),d.setAttribute("oninput","validity.valid||(value='');");const s=document.createElement("div");s.setAttribute("class","form-group");const u=document.createElement("label"),m=document.createElement("input");s.append(m,u),u.textContent="Completed?",u.setAttribute("for","completed"),m.setAttribute("id","completed"),m.setAttribute("type","checkbox"),m.setAttribute("name","completed");const p=document.createElement("i");p.setAttribute("type","button"),p.setAttribute("id","submit"),p.setAttribute("class","material-icons-round"),p.innerHTML="done",p.addEventListener("click",o);const b=document.createElement("i");return b.setAttribute("type","button"),b.setAttribute("id","cancel"),b.setAttribute("class","material-icons-round"),b.innerHTML="close",b.formNoValidate=!0,b.addEventListener("click",(()=>{document.querySelector("#addNewButton").style.display="block",document.querySelector("#input-field").style.display="none",function(){const t=document.querySelectorAll("input");for(let e=0;e<t.length-1;e++)t[e].value="",t[t.length-1].checked=!1}()})),n.append(i,l,c,s,p,b),t.appendChild(n),t}());for(let e=0;e<b.length;e++){let i=n(b[e],e);t.appendChild(i)}}function o(){const n=document.querySelectorAll("input");for(let t=0;t<n.length-1;t++)if(""==n[t].value)return void alert("fill in all the details before submitting");const i=new t(n[0].value,n[1].value,n[2].value,n[3].checked);b.push(i),p(),e()}function a(t){return(t=t.toLowerCase()).replace(/(^|\s)\S/g,(function(t){return t.toUpperCase()}))}function c(t){let e=m(this.id),n=b[e];const i=document.getElementById(`card ${e}`).querySelector(".content"),r=document.getElementById(`update-input-field${e}`).querySelectorAll("input");for(let t=0;t<r.length;t++)if(""==r[t].value)return void alert("input cannot be left empty!");n.title=r[0].value,i.querySelector(".bookTitle").innerHTML=n.title,i.querySelector(".bookTitle").title=`Title: "${n.title}"`,n.author=r[1].value,i.querySelector(".bookAuthor").innerHTML=n.author,i.querySelector(".bookAuthor").title=`Author: "${n.author}"`,n.pages_total=r[2].value,p(),document.getElementById(`update-input-field${e}`).remove(),i.style.display="block"}function d(t){let e=m(this.id),n=b[e];n.complete=!n.complete,p();const i=document.getElementById(this.id);n.complete?(i.innerHTML="check_circle_outline",i.title="Mark as Incomplete"):(i.innerHTML="visibility",i.title="Mark as Complete")}function s(t){let n=m(this.id);b.splice(n,1),p(),e()}function u(t){let e=m(this.id),n=b[e];const i=document.getElementById(`card ${e}`);i.querySelector(".cardFace").style.display="none";const r=document.createElement("form");r.id=`update-input-field${e}`;const l=document.createElement("div"),o=document.createElement("input");l.appendChild(o),o.setAttribute("value",n.title),o.setAttribute("type","text"),o.setAttribute("name","Edit Title"),o.minlength=1;const a=document.createElement("div"),d=document.createElement("input");a.appendChild(d),d.setAttribute("value",n.author),d.setAttribute("type","text"),d.setAttribute("name","Edit Author"),d.required=!0;const s=document.createElement("div"),u=document.createElement("input");s.appendChild(u),u.setAttribute("value",n.pages_total),u.setAttribute("type","number"),u.setAttribute("name","Edit Total Pages"),u.setAttribute("min","0"),u.setAttribute("oninput","validity.valid||(value='');"),u.required=!0;const p=document.createElement("i");p.setAttribute("type","button"),p.setAttribute("class","material-icons-round"),p.setAttribute("id",`update ${e}`),p.innerHTML="done",p.addEventListener("click",c);const A=document.createElement("i");A.setAttribute("type","button"),A.setAttribute("class","material-icons-round"),A.innerHTML="close",A.formNoValidate=!0,A.addEventListener("click",(()=>{i.querySelector(".cardFace").style.display="initial";let t=m(this.id);document.querySelector(`#update-input-field${t}`).remove()})),r.append(l,a,s,p,A),i.appendChild(r),o.focus()}function m(t){return t.replace(/\D/g,"")}function p(){localStorage.setItem("library",JSON.stringify(b))}let b=[];!function(){if(localStorage.library){let t=localStorage.getItem("library");t=JSON.parse(t),b=t,l()}else l()}()})();